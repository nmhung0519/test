<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" tyle="text/css" href="style.css">
    </head>
    <body>
        <div id="frame"></div>
    </body>
    <script>
        var x, y;
        var tmpX, tmpY;
        var target = null;
        var direction = null;
        createImage('picture/1-01.jpg', 3, 4);
        addEventListener("mousedown", function (event) {
            addEventListener("mousemove", move);
            x = event.screenX;
            y = event.screenY;
        })
        addEventListener("mouseup", function (t) {
            if(target != null) target.style.transform = 'scale(1)';
            removeEventListener("mousemove", move);
            if (target != null) console.log(target.style.left, target.style.top);
            target = null;
        })
        function ch(event) {
            if (target == null) {
                if (event.screenX != x) {
                    select(event.target);
                    direction = 1;
                }
                else {
                    select(event.target)
                    direction = 2;
                }
            }
            else {
                //console.log(direction);
                if (direction == 1) {
                    if (event.screenX != x) {
                        var tmp = tmpX + (event.screenX - x);
                        if (tmp < 0) tmp = 0;
                        target.style.left = tmp + "px";
                    }
                }
                else if (direction == 2) {
                    if (event.screenY != y) {
                        var tmp = tmpY + (event.screenY - y);
                        if (tmp < 0) tmp = 0;
                        target.style.top = tmp + "px";
                    }
                }
            }
        }
        function select(_target) {
            target = _target;
            target.style.transform = 'scale(1.1)';
            tmpY = new Number((target.style.top).slice(0, -2));
            tmpX = new Number((target.style.left).slice(0, -2));
        }
        function createImage(file, n, m) {
            for (var i = 0; i < n; i++) {
                for (var j = 0; j < m; j++) {
                    var tmp = document.createElement("div");
                    tmp.className = 'piece';
                    tmp.style.width = 960 / m + "px";
                    tmp.style.height = 540 / n + "px";
                    tmp.style.background = 'url(' + file + ')';
                    tmp.style.backgroundPositionX = j * (960 / m) + "px";
                    tmp.style.backgroundPositionY = i * (540 / n) + 'px';
                    tmp.style.position = 'absolute';
                    tmp.style.transition = '0.1s';
                    tmp.style.left = j * (960 / m) + "px";
                    tmp.style.top = i * (540 / n) + 'px';
                    frame.appendChild(tmp);
                }
            }

        }
    </script>
</html>